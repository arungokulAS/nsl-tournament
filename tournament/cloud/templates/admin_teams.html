{% load static %}
{% extends 'nsl_home.html' %}
{% block content %}
<div class="modern-table-container">
    <div class="modern-table-title">Teams Management</div>
    <nav class="admin-nav" style="margin-bottom:24px; text-align:center;">
        <a href="/tadmin/teams/" class="neon-btn" style="margin:0 8px 8px 0;">Teams</a>
        <a href="/tadmin/groups/" class="neon-btn" style="margin:0 8px 8px 0;">Groups</a>
        <a href="/tadmin/schedule/" class="neon-btn" style="margin:0 8px 8px 0;">Schedule</a>
        <a href="/tadmin/live/" class="neon-btn" style="margin:0 8px 8px 0;">Live Match</a>
        <a href="/tadmin/finish-rounds/" class="neon-btn" style="margin:0 8px 8px 0;">Finish Rounds</a>
    </nav>
    {% if messages %}
        <div style="margin: 16px 0; text-align: center;">
            {% for message in messages %}
                <div style="background:#ffd2d2; color:#a00; padding:8px 0; margin-bottom:8px; border-radius:6px;">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}
    {% if not is_locked %}
    <form method="post" class="add-team-form">
        {% csrf_token %}
        <input type="hidden" name="action" value="add">
        <div class="add-team-fields">
            <input type="text" name="player1_name" placeholder="Player 1 Name" required>
            <input type="text" name="player2_name" placeholder="Player 2 Name" required>
            <button type="submit" class="neon-btn">Add Team</button>
        </div>
    </form>
    {% endif %}
    <form method="post" enctype="multipart/form-data" class="upload-csv-form">
        {% csrf_token %}
        <input type="hidden" name="action" value="upload_csv">
        <label class="neon-btn" style="margin-bottom:8px;">
            Choose CSV File
            <input type="file" name="csv_file" accept=".csv" style="display:none;" required onchange="this.form.submit()">
        </label>
        <span style="font-size:0.95em; color:#aaa; margin-left:12px;">CSV columns: Player 1, Player 2 (no header row)</span>
    </form>
    <form method="post" class="clear-all-form">
        {% csrf_token %}
        <input type="hidden" name="action" value="clear_all">
        <input type="password" name="password" placeholder="Admin Password" required>
        <button type="submit" class="neon-btn" style="background:#a020f0;">Clear All</button>
    </form>
    {% if is_locked %}
        <div class="neon-btn" style="background:rgba(40,20,60,0.92);color:#fff;text-align:center;margin-bottom:12px;">Teams are <b>locked</b>. No changes allowed.</div>
    {% endif %}
    <div class="team-table-wrapper">
        <table class="modern-table">
            <thead>
                <tr>
                    <th>No</th>
                    <th>Team Name</th>
                    <th>Player 1</th>
                    <th>Player 2</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for team in teams %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ team.team_name }}</td>
                    <td>{{ team.player1_name }}</td>
                    <td>{{ team.player2_name }}</td>
                    <td class="{% if is_locked %}status-locked{% else %}status-active{% endif %}">{% if is_locked %}Locked{% else %}Active{% endif %}</td>
                    <td>
                        {% if not is_locked %}
                            <form method="post" action="/tadmin/teams/" style="display:inline;">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="edit">
                                <input type="hidden" name="team_id" value="{{ team.team_id }}">
                                <button type="submit" class="icon-btn" title="Edit"><svg width="20" height="20" fill="none" stroke="#a020f0" stroke-width="2"><path d="M4 16l6-6 6 6"/></svg></button>
                            </form>
                            <form method="post" action="/tadmin/teams/" style="display:inline;" onsubmit="return confirm('Delete this team? Enter admin password to confirm.');">
                                {% csrf_token %}
                                <input type="hidden" name="action" value="delete">
                                <input type="hidden" name="team_id" value="{{ team.team_id }}">
                                <input type="password" name="password" placeholder="Admin Password" required style="margin-right:4px;">
                                <button type="submit" class="icon-btn" title="Delete"><svg width="20" height="20" fill="none" stroke="#a020f0" stroke-width="2"><path d="M6 6l8 8M6 14l8-8"/></svg></button>
                            </form>
                        {% else %}
                            <span style="color:#888;">Locked</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
<style>
    .modern-table-container {
        max-width: 900px;
        margin: 48px auto 0 auto;
        background: rgba(34, 34, 44, 0.72);
        border-radius: 18px;
        box-shadow: 0 4px 32px 0 #a020f0cc, 0 1.5px 8px 0 #0008, 0 0 32px 8px #4e7fff44;
        padding: 32px 28px 36px 28px;
        color: #eaf0fa;
        backdrop-filter: blur(16px) saturate(180%);
        border: 2.5px solid #a020f0;
        box-shadow: 0 0 24px 6px #a020f0aa inset, 0 0 32px 8px #4e7fff44;
    }
    .modern-table-title {
        text-align: center;
        font-size: 2.1rem;
        font-weight: 700;
        margin-bottom: 28px;
        letter-spacing: 0.01em;
        color: #fff;
        text-shadow: 0 2px 24px #a020f0, 0 2px 16px #4e7fff, 0 0 8px #fff;
        animation: neonGlowTitle 1.8s ease-in-out infinite alternate;
    }
    .modern-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        background: #23233a;
        border-radius: 12px;
        overflow: hidden;
        /* box-shadow removed for no outer glow */
    }
    .modern-table th, .modern-table td {
        padding: 14px 12px;
        text-align: center;
        font-size: 1.08em;
    }
    .modern-table th {
        background: linear-gradient(90deg, #4e7fff 0%, #a020f0 100%);
        color: #fff;
        font-weight: 700;
        border-bottom: 2px solid #3a3a5a;
        letter-spacing: 0.04em;
        text-shadow: 0 0 12px #a020f0, 0 0 8px #4e7fff;
    }
    .modern-table tr {
        transition: background 0.2s;
    }
    .modern-table tbody tr:nth-child(even) {
        background: rgba(160,32,240,0.07);
    }
    .modern-table tbody tr:nth-child(odd) {
        background: rgba(78,127,255,0.06);
    }
    .modern-table tbody tr:hover {
        background: #2a2a4a;
    }
    .modern-table td {
        border-bottom: 1px solid #2e2e44;
        color: #eaf0fa;
    }
    .modern-table td.status-active {
        color: #20f060;
        font-weight: 600;
        text-shadow: 0 0 12px #20f060, 0 0 8px #fff;
        animation: neonGlowSuccess 1.2s ease-in-out infinite alternate;
    }
    .modern-table td.status-locked {
        color: #ff4e7f;
        font-weight: 600;
        text-shadow: 0 0 12px #ff4e7f, 0 0 8px #fff;
        animation: neonGlowError 1.2s ease-in-out infinite alternate;
    }
    @media (max-width: 700px) {
        .modern-table-container { padding: 10px 2vw; }
        .modern-table-title { font-size: 1.3rem; }
        .modern-table th, .modern-table td { padding: 8px 4px; font-size: 0.98em; }
    }
</style>
{% endblock %}
<style>
.add-team-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
    align-items: center;
    margin-bottom: 24px;
}
.add-team-fields {
    display: flex;
    gap: 12px;
    width: 100%;
    justify-content: center;
}
.add-team-fields input {
    min-width: 160px;
    padding: 8px 12px;
    border-radius: 8px;
    border: 1.5px solid #4e7fff;
    background: rgba(20,20,30,0.85);
    color: #fff;
    font-size: 1em;
    box-shadow: 0 0 8px 2px #4e7fff33;
    backdrop-filter: blur(4px);
}
.neon-btn {
    min-width: 120px;
    padding: 8px 18px;
    font-weight: 600;
    font-size: 1em;
    background: linear-gradient(90deg, #a020f0 0%, #4e7fff 100%);
    color: #fff;
    border: none;
    border-radius: 8px;
    box-shadow: 0 0 16px 4px #a020f0, 0 0 8px 2px #4e7fff;
    cursor: pointer;
    transition: box-shadow 0.2s, background 0.2s;
    text-shadow: 0 0 8px #fff, 0 0 16px #a020f0;
    animation: neonGlowBtn 1.5s ease-in-out infinite alternate;
}
@keyframes neonGlowBtn {
    0% { box-shadow: 0 0 16px 4px #a020f0, 0 0 8px 2px #4e7fff; }
    100% { box-shadow: 0 0 32px 8px #a020f0, 0 0 16px 4px #4e7fff; }
}
@keyframes neonGlowTitle {
    0% { text-shadow: 0 2px 24px #a020f0, 0 2px 16px #4e7fff, 0 0 8px #fff; }
    100% { text-shadow: 0 2px 32px #a020f0, 0 2px 24px #4e7fff, 0 0 16px #fff; }
}
@keyframes neonGlowSuccess {
    0% { text-shadow: 0 0 12px #20f060, 0 0 8px #fff; }
    100% { text-shadow: 0 0 24px #20f060, 0 0 16px #fff; }
}
@keyframes neonGlowError {
    0% { text-shadow: 0 0 12px #ff4e7f, 0 0 8px #fff; }
    100% { text-shadow: 0 0 24px #ff4e7f, 0 0 16px #fff; }
}
.clear-all-form, .upload-csv-form {
    display: flex;
    flex-direction: row;
    gap: 12px;
    align-items: center;
    margin-bottom: 18px;
}
.team-table-wrapper {
    margin-top: 24px;
}
.team-table {
    width: 100%;
    border-collapse: collapse;
}
.team-table th, .team-table td {
    padding: 10px 8px;
    text-align: center;
}
.team-table th {
    background: rgba(160,32,240,0.12);
    color: #fff;
    font-weight: 700;
}
.team-table tr {
    border-bottom: 1px solid rgba(160,32,240,0.08);
}
body {
    background: #18181b url('{% static "envato-labs-image-edit-1.png" %}') repeat;
    min-height: 100vh;
    margin: 0;
}
</style>
{% endblock %}
